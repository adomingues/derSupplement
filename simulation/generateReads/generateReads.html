<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="L Collado-Torres" />

<meta name="date" content="2015-11-19" />

<title>Simulate reads</title>


<style type="text/css">code{white-space: pre;}</style>
<link href="data:text/css;charset=utf-8,pre%20%2Eoperator%2C%0Apre%20%2Eparen%7Bcolor%3Argb%28104%2C%20118%2C%20135%29%7Dpre%20%2Eliteral%7Bcolor%3A%23990073%7Dpre%20%2Enumber%7Bcolor%3A%23099%7Dpre%20%2Ecomment%7Bcolor%3A%23998%3Bfont%2Dstyle%3Aitalic%7Dpre%20%2Ekeyword%7Bcolor%3A%23900%3Bfont%2Dweight%3Abold%7Dpre%20%2Eidentifier%7Bcolor%3Argb%280%2C%200%2C%200%29%7Dpre%20%2Estring%7Bcolor%3A%23d14%7D" rel="stylesheet" type="text/css" />
<script src="data:application/x-javascript;base64,CnZhciBobGpzPW5ldyBmdW5jdGlvbigpe2Z1bmN0aW9uIG0ocCl7cmV0dXJuIHAucmVwbGFjZSgvJi9nbSwiJmFtcDsiKS5yZXBsYWNlKC88L2dtLCImbHQ7Iil9ZnVuY3Rpb24gZihyLHEscCl7cmV0dXJuIFJlZ0V4cChxLCJtIisoci5jST8iaSI6IiIpKyhwPyJnIjoiIikpfWZ1bmN0aW9uIGIocil7Zm9yKHZhciBwPTA7cDxyLmNoaWxkTm9kZXMubGVuZ3RoO3ArKyl7dmFyIHE9ci5jaGlsZE5vZGVzW3BdO2lmKHEubm9kZU5hbWU9PSJDT0RFIil7cmV0dXJuIHF9aWYoIShxLm5vZGVUeXBlPT0zJiZxLm5vZGVWYWx1ZS5tYXRjaCgvXHMrLykpKXticmVha319fWZ1bmN0aW9uIGgodCxzKXt2YXIgcD0iIjtmb3IodmFyIHI9MDtyPHQuY2hpbGROb2Rlcy5sZW5ndGg7cisrKXtpZih0LmNoaWxkTm9kZXNbcl0ubm9kZVR5cGU9PTMpe3ZhciBxPXQuY2hpbGROb2Rlc1tyXS5ub2RlVmFsdWU7aWYocyl7cT1xLnJlcGxhY2UoL1xuL2csIiIpfXArPXF9ZWxzZXtpZih0LmNoaWxkTm9kZXNbcl0ubm9kZU5hbWU9PSJCUiIpe3ArPSJcbiJ9ZWxzZXtwKz1oKHQuY2hpbGROb2Rlc1tyXSl9fX1pZigvTVNJRSBbNjc4XS8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSl7cD1wLnJlcGxhY2UoL1xyL2csIlxuIil9cmV0dXJuIHB9ZnVuY3Rpb24gYShzKXt2YXIgcj1zLmNsYXNzTmFtZS5zcGxpdCgvXHMrLyk7cj1yLmNvbmNhdChzLnBhcmVudE5vZGUuY2xhc3NOYW1lLnNwbGl0KC9ccysvKSk7Zm9yKHZhciBxPTA7cTxyLmxlbmd0aDtxKyspe3ZhciBwPXJbcV0ucmVwbGFjZSgvXmxhbmd1YWdlLS8sIiIpO2lmKGVbcF0pe3JldHVybiBwfX19ZnVuY3Rpb24gYyhxKXt2YXIgcD1bXTsoZnVuY3Rpb24ocyx0KXtmb3IodmFyIHI9MDtyPHMuY2hpbGROb2Rlcy5sZW5ndGg7cisrKXtpZihzLmNoaWxkTm9kZXNbcl0ubm9kZVR5cGU9PTMpe3QrPXMuY2hpbGROb2Rlc1tyXS5ub2RlVmFsdWUubGVuZ3RofWVsc2V7aWYocy5jaGlsZE5vZGVzW3JdLm5vZGVOYW1lPT0iQlIiKXt0Kz0xfWVsc2V7aWYocy5jaGlsZE5vZGVzW3JdLm5vZGVUeXBlPT0xKXtwLnB1c2goe2V2ZW50OiJzdGFydCIsb2Zmc2V0OnQsbm9kZTpzLmNoaWxkTm9kZXNbcl19KTt0PWFyZ3VtZW50cy5jYWxsZWUocy5jaGlsZE5vZGVzW3JdLHQpO3AucHVzaCh7ZXZlbnQ6InN0b3AiLG9mZnNldDp0LG5vZGU6cy5jaGlsZE5vZGVzW3JdfSl9fX19cmV0dXJuIHR9KShxLDApO3JldHVybiBwfWZ1bmN0aW9uIGsoeSx3LHgpe3ZhciBxPTA7dmFyIHo9IiI7dmFyIHM9W107ZnVuY3Rpb24gdSgpe2lmKHkubGVuZ3RoJiZ3Lmxlbmd0aCl7aWYoeVswXS5vZmZzZXQhPXdbMF0ub2Zmc2V0KXtyZXR1cm4oeVswXS5vZmZzZXQ8d1swXS5vZmZzZXQpP3k6d31lbHNle3JldHVybiB3WzBdLmV2ZW50PT0ic3RhcnQiP3k6d319ZWxzZXtyZXR1cm4geS5sZW5ndGg/eTp3fX1mdW5jdGlvbiB0KEQpe3ZhciBBPSI8IitELm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7Zm9yKHZhciBCPTA7QjxELmF0dHJpYnV0ZXMubGVuZ3RoO0IrKyl7dmFyIEM9RC5hdHRyaWJ1dGVzW0JdO0ErPSIgIitDLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7aWYoQy52YWx1ZSE9PXVuZGVmaW5lZCYmQy52YWx1ZSE9PWZhbHNlJiZDLnZhbHVlIT09bnVsbCl7QSs9Jz0iJyttKEMudmFsdWUpKyciJ319cmV0dXJuIEErIj4ifXdoaWxlKHkubGVuZ3RofHx3Lmxlbmd0aCl7dmFyIHY9dSgpLnNwbGljZSgwLDEpWzBdO3orPW0oeC5zdWJzdHIocSx2Lm9mZnNldC1xKSk7cT12Lm9mZnNldDtpZih2LmV2ZW50PT0ic3RhcnQiKXt6Kz10KHYubm9kZSk7cy5wdXNoKHYubm9kZSl9ZWxzZXtpZih2LmV2ZW50PT0ic3RvcCIpe3ZhciBwLHI9cy5sZW5ndGg7ZG97ci0tO3A9c1tyXTt6Kz0oIjwvIitwLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkrIj4iKX13aGlsZShwIT12Lm5vZGUpO3Muc3BsaWNlKHIsMSk7d2hpbGUocjxzLmxlbmd0aCl7eis9dChzW3JdKTtyKyt9fX19cmV0dXJuIHorbSh4LnN1YnN0cihxKSl9ZnVuY3Rpb24gaigpe2Z1bmN0aW9uIHEoeCx5LHYpe2lmKHguY29tcGlsZWQpe3JldHVybn12YXIgdTt2YXIgcz1bXTtpZih4Lmspe3gubFI9Zih5LHgubHx8aGxqcy5JUix0cnVlKTtmb3IodmFyIHcgaW4geC5rKXtpZigheC5rLmhhc093blByb3BlcnR5KHcpKXtjb250aW51ZX1pZih4Lmtbd10gaW5zdGFuY2VvZiBPYmplY3Qpe3U9eC5rW3ddfWVsc2V7dT14Lms7dz0ia2V5d29yZCJ9Zm9yKHZhciByIGluIHUpe2lmKCF1Lmhhc093blByb3BlcnR5KHIpKXtjb250aW51ZX14Lmtbcl09W3csdVtyXV07cy5wdXNoKHIpfX19aWYoIXYpe2lmKHguYldLKXt4LmI9IlxcYigiK3Muam9pbigifCIpKyIpXFxzIn14LmJSPWYoeSx4LmI/eC5iOiJcXEJ8XFxiIik7aWYoIXguZSYmIXguZVcpe3guZT0iXFxCfFxcYiJ9aWYoeC5lKXt4LmVSPWYoeSx4LmUpfX1pZih4Lmkpe3guaVI9Zih5LHguaSl9aWYoeC5yPT09dW5kZWZpbmVkKXt4LnI9MX1pZigheC5jKXt4LmM9W119eC5jb21waWxlZD10cnVlO2Zvcih2YXIgdD0wO3Q8eC5jLmxlbmd0aDt0Kyspe2lmKHguY1t0XT09InNlbGYiKXt4LmNbdF09eH1xKHguY1t0XSx5LGZhbHNlKX1pZih4LnN0YXJ0cyl7cSh4LnN0YXJ0cyx5LGZhbHNlKX19Zm9yKHZhciBwIGluIGUpe2lmKCFlLmhhc093blByb3BlcnR5KHApKXtjb250aW51ZX1xKGVbcF0uZE0sZVtwXSx0cnVlKX19ZnVuY3Rpb24gZChCLEMpe2lmKCFqLmNhbGxlZCl7aigpO2ouY2FsbGVkPXRydWV9ZnVuY3Rpb24gcShyLE0pe2Zvcih2YXIgTD0wO0w8TS5jLmxlbmd0aDtMKyspe2lmKChNLmNbTF0uYlIuZXhlYyhyKXx8W251bGxdKVswXT09cil7cmV0dXJuIE0uY1tMXX19fWZ1bmN0aW9uIHYoTCxyKXtpZihEW0xdLmUmJkRbTF0uZVIudGVzdChyKSl7cmV0dXJuIDF9aWYoRFtMXS5lVyl7dmFyIE09dihMLTEscik7cmV0dXJuIE0/TSsxOjB9cmV0dXJuIDB9ZnVuY3Rpb24gdyhyLEwpe3JldHVybiBMLmkmJkwuaVIudGVzdChyKX1mdW5jdGlvbiBLKE4sTyl7dmFyIE09W107Zm9yKHZhciBMPTA7TDxOLmMubGVuZ3RoO0wrKyl7TS5wdXNoKE4uY1tMXS5iKX12YXIgcj1ELmxlbmd0aC0xO2Rve2lmKERbcl0uZSl7TS5wdXNoKERbcl0uZSl9ci0tfXdoaWxlKERbcisxXS5lVyk7aWYoTi5pKXtNLnB1c2goTi5pKX1yZXR1cm4gZihPLE0uam9pbigifCIpLHRydWUpfWZ1bmN0aW9uIHAoTSxMKXt2YXIgTj1EW0QubGVuZ3RoLTFdO2lmKCFOLnQpe04udD1LKE4sRSl9Ti50Lmxhc3RJbmRleD1MO3ZhciByPU4udC5leGVjKE0pO3JldHVybiByP1tNLnN1YnN0cihMLHIuaW5kZXgtTCksclswXSxmYWxzZV06W00uc3Vic3RyKEwpLCIiLHRydWVdfWZ1bmN0aW9uIHooTixyKXt2YXIgTD1FLmNJP3JbMF0udG9Mb3dlckNhc2UoKTpyWzBdO3ZhciBNPU4ua1tMXTtpZihNJiZNIGluc3RhbmNlb2YgQXJyYXkpe3JldHVybiBNfXJldHVybiBmYWxzZX1mdW5jdGlvbiBGKEwsUCl7TD1tKEwpO2lmKCFQLmspe3JldHVybiBMfXZhciByPSIiO3ZhciBPPTA7UC5sUi5sYXN0SW5kZXg9MDt2YXIgTT1QLmxSLmV4ZWMoTCk7d2hpbGUoTSl7cis9TC5zdWJzdHIoTyxNLmluZGV4LU8pO3ZhciBOPXooUCxNKTtpZihOKXt4Kz1OWzFdO3IrPSc8c3BhbiBjbGFzcz0iJytOWzBdKyciPicrTVswXSsiPC9zcGFuPiJ9ZWxzZXtyKz1NWzBdfU89UC5sUi5sYXN0SW5kZXg7TT1QLmxSLmV4ZWMoTCl9cmV0dXJuIHIrTC5zdWJzdHIoTyxMLmxlbmd0aC1PKX1mdW5jdGlvbiBKKEwsTSl7aWYoTS5zTCYmZVtNLnNMXSl7dmFyIHI9ZChNLnNMLEwpO3grPXIua2V5d29yZF9jb3VudDtyZXR1cm4gci52YWx1ZX1lbHNle3JldHVybiBGKEwsTSl9fWZ1bmN0aW9uIEkoTSxyKXt2YXIgTD1NLmNOPyc8c3BhbiBjbGFzcz0iJytNLmNOKyciPic6IiI7aWYoTS5yQil7eSs9TDtNLmJ1ZmZlcj0iIn1lbHNle2lmKE0uZUIpe3krPW0ocikrTDtNLmJ1ZmZlcj0iIn1lbHNle3krPUw7TS5idWZmZXI9cn19RC5wdXNoKE0pO0ErPU0ucn1mdW5jdGlvbiBHKE4sTSxRKXt2YXIgUj1EW0QubGVuZ3RoLTFdO2lmKFEpe3krPUooUi5idWZmZXIrTixSKTtyZXR1cm4gZmFsc2V9dmFyIFA9cShNLFIpO2lmKFApe3krPUooUi5idWZmZXIrTixSKTtJKFAsTSk7cmV0dXJuIFAuckJ9dmFyIEw9dihELmxlbmd0aC0xLE0pO2lmKEwpe3ZhciBPPVIuY04/Ijwvc3Bhbj4iOiIiO2lmKFIuckUpe3krPUooUi5idWZmZXIrTixSKStPfWVsc2V7aWYoUi5lRSl7eSs9SihSLmJ1ZmZlcitOLFIpK08rbShNKX1lbHNle3krPUooUi5idWZmZXIrTitNLFIpK099fXdoaWxlKEw+MSl7Tz1EW0QubGVuZ3RoLTJdLmNOPyI8L3NwYW4+IjoiIjt5Kz1PO0wtLTtELmxlbmd0aC0tfXZhciByPURbRC5sZW5ndGgtMV07RC5sZW5ndGgtLTtEW0QubGVuZ3RoLTFdLmJ1ZmZlcj0iIjtpZihyLnN0YXJ0cyl7SShyLnN0YXJ0cywiIil9cmV0dXJuIFIuckV9aWYodyhNLFIpKXt0aHJvdyJJbGxlZ2FsIn19dmFyIEU9ZVtCXTt2YXIgRD1bRS5kTV07dmFyIEE9MDt2YXIgeD0wO3ZhciB5PSIiO3RyeXt2YXIgcyx1PTA7RS5kTS5idWZmZXI9IiI7ZG97cz1wKEMsdSk7dmFyIHQ9RyhzWzBdLHNbMV0sc1syXSk7dSs9c1swXS5sZW5ndGg7aWYoIXQpe3UrPXNbMV0ubGVuZ3RofX13aGlsZSghc1syXSk7aWYoRC5sZW5ndGg+MSl7dGhyb3ciSWxsZWdhbCJ9cmV0dXJue3I6QSxrZXl3b3JkX2NvdW50OngsdmFsdWU6eX19Y2F0Y2goSCl7aWYoSD09IklsbGVnYWwiKXtyZXR1cm57cjowLGtleXdvcmRfY291bnQ6MCx2YWx1ZTptKEMpfX1lbHNle3Rocm93IEh9fX1mdW5jdGlvbiBnKHQpe3ZhciBwPXtrZXl3b3JkX2NvdW50OjAscjowLHZhbHVlOm0odCl9O3ZhciByPXA7Zm9yKHZhciBxIGluIGUpe2lmKCFlLmhhc093blByb3BlcnR5KHEpKXtjb250aW51ZX12YXIgcz1kKHEsdCk7cy5sYW5ndWFnZT1xO2lmKHMua2V5d29yZF9jb3VudCtzLnI+ci5rZXl3b3JkX2NvdW50K3Iucil7cj1zfWlmKHMua2V5d29yZF9jb3VudCtzLnI+cC5rZXl3b3JkX2NvdW50K3Aucil7cj1wO3A9c319aWYoci5sYW5ndWFnZSl7cC5zZWNvbmRfYmVzdD1yfXJldHVybiBwfWZ1bmN0aW9uIGkocixxLHApe2lmKHEpe3I9ci5yZXBsYWNlKC9eKCg8W14+XSs+fFx0KSspL2dtLGZ1bmN0aW9uKHQsdyx2LHUpe3JldHVybiB3LnJlcGxhY2UoL1x0L2cscSl9KX1pZihwKXtyPXIucmVwbGFjZSgvXG4vZywiPGJyPiIpfXJldHVybiByfWZ1bmN0aW9uIG4odCx3LHIpe3ZhciB4PWgodCxyKTt2YXIgdj1hKHQpO3ZhciB5LHM7aWYodil7eT1kKHYseCl9ZWxzZXtyZXR1cm59dmFyIHE9Yyh0KTtpZihxLmxlbmd0aCl7cz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJwcmUiKTtzLmlubmVySFRNTD15LnZhbHVlO3kudmFsdWU9ayhxLGMocykseCl9eS52YWx1ZT1pKHkudmFsdWUsdyxyKTt2YXIgdT10LmNsYXNzTmFtZTtpZighdS5tYXRjaCgiKFxcc3xeKShsYW5ndWFnZS0pPyIrdisiKFxcc3wkKSIpKXt1PXU/KHUrIiAiK3YpOnZ9aWYoL01TSUUgWzY3OF0vLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkmJnQudGFnTmFtZT09IkNPREUiJiZ0LnBhcmVudE5vZGUudGFnTmFtZT09IlBSRSIpe3M9dC5wYXJlbnROb2RlO3ZhciBwPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpO3AuaW5uZXJIVE1MPSI8cHJlPjxjb2RlPiIreS52YWx1ZSsiPC9jb2RlPjwvcHJlPiI7dD1wLmZpcnN0Q2hpbGQuZmlyc3RDaGlsZDtwLmZpcnN0Q2hpbGQuY049cy5jTjtzLnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKHAuZmlyc3RDaGlsZCxzKX1lbHNle3QuaW5uZXJIVE1MPXkudmFsdWV9dC5jbGFzc05hbWU9dTt0LnJlc3VsdD17bGFuZ3VhZ2U6dixrdzp5LmtleXdvcmRfY291bnQscmU6eS5yfTtpZih5LnNlY29uZF9iZXN0KXt0LnNlY29uZF9iZXN0PXtsYW5ndWFnZTp5LnNlY29uZF9iZXN0Lmxhbmd1YWdlLGt3Onkuc2Vjb25kX2Jlc3Qua2V5d29yZF9jb3VudCxyZTp5LnNlY29uZF9iZXN0LnJ9fX1mdW5jdGlvbiBvKCl7aWYoby5jYWxsZWQpe3JldHVybn1vLmNhbGxlZD10cnVlO3ZhciByPWRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJwcmUiKTtmb3IodmFyIHA9MDtwPHIubGVuZ3RoO3ArKyl7dmFyIHE9YihyW3BdKTtpZihxKXtuKHEsaGxqcy50YWJSZXBsYWNlKX19fWZ1bmN0aW9uIGwoKXtpZih3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcil7d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLG8sZmFsc2UpO3dpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJsb2FkIixvLGZhbHNlKX1lbHNle2lmKHdpbmRvdy5hdHRhY2hFdmVudCl7d2luZG93LmF0dGFjaEV2ZW50KCJvbmxvYWQiLG8pfWVsc2V7d2luZG93Lm9ubG9hZD1vfX19dmFyIGU9e307dGhpcy5MQU5HVUFHRVM9ZTt0aGlzLmhpZ2hsaWdodD1kO3RoaXMuaGlnaGxpZ2h0QXV0bz1nO3RoaXMuZml4TWFya3VwPWk7dGhpcy5oaWdobGlnaHRCbG9jaz1uO3RoaXMuaW5pdEhpZ2hsaWdodGluZz1vO3RoaXMuaW5pdEhpZ2hsaWdodGluZ09uTG9hZD1sO3RoaXMuSVI9IlthLXpBLVpdW2EtekEtWjAtOV9dKiI7dGhpcy5VSVI9IlthLXpBLVpfXVthLXpBLVowLTlfXSoiO3RoaXMuTlI9IlxcYlxcZCsoXFwuXFxkKyk/Ijt0aGlzLkNOUj0iXFxiKDBbeFhdW2EtZkEtRjAtOV0rfChcXGQrKFxcLlxcZCopP3xcXC5cXGQrKShbZUVdWy0rXT9cXGQrKT8pIjt0aGlzLkJOUj0iXFxiKDBiWzAxXSspIjt0aGlzLlJTUj0iIXwhPXwhPT18JXwlPXwmfCYmfCY9fFxcKnxcXCo9fFxcK3xcXCs9fCx8XFwufC18LT18L3wvPXw6fDt8PHw8PHw8PD18PD18PXw9PXw9PT18Pnw+PXw+Pnw+Pj18Pj4+fD4+Pj18XFw/fFxcW3xcXHt8XFwofFxcXnxcXF49fFxcfHxcXHw9fFxcfFxcfHx+Ijt0aGlzLkVSPSIoPyFbXFxzXFxTXSkiO3RoaXMuQkU9e2I6IlxcXFwuIixyOjB9O3RoaXMuQVNNPXtjTjoic3RyaW5nIixiOiInIixlOiInIixpOiJcXG4iLGM6W3RoaXMuQkVdLHI6MH07dGhpcy5RU009e2NOOiJzdHJpbmciLGI6JyInLGU6JyInLGk6IlxcbiIsYzpbdGhpcy5CRV0scjowfTt0aGlzLkNMQ009e2NOOiJjb21tZW50IixiOiIvLyIsZToiJCJ9O3RoaXMuQ0JMQ0xNPXtjTjoiY29tbWVudCIsYjoiL1xcKiIsZToiXFwqLyJ9O3RoaXMuSENNPXtjTjoiY29tbWVudCIsYjoiIyIsZToiJCJ9O3RoaXMuTk09e2NOOiJudW1iZXIiLGI6dGhpcy5OUixyOjB9O3RoaXMuQ05NPXtjTjoibnVtYmVyIixiOnRoaXMuQ05SLHI6MH07dGhpcy5CTk09e2NOOiJudW1iZXIiLGI6dGhpcy5CTlIscjowfTt0aGlzLmluaGVyaXQ9ZnVuY3Rpb24ocixzKXt2YXIgcD17fTtmb3IodmFyIHEgaW4gcil7cFtxXT1yW3FdfWlmKHMpe2Zvcih2YXIgcSBpbiBzKXtwW3FdPXNbcV19fXJldHVybiBwfX0oKTtobGpzLkxBTkdVQUdFUy5jcHA9ZnVuY3Rpb24oKXt2YXIgYT17a2V5d29yZDp7ImZhbHNlIjoxLCJpbnQiOjEsImZsb2F0IjoxLCJ3aGlsZSI6MSwicHJpdmF0ZSI6MSwiY2hhciI6MSwiY2F0Y2giOjEsImV4cG9ydCI6MSx2aXJ0dWFsOjEsb3BlcmF0b3I6MixzaXplb2Y6MixkeW5hbWljX2Nhc3Q6Mix0eXBlZGVmOjIsY29uc3RfY2FzdDoyLCJjb25zdCI6MSxzdHJ1Y3Q6MSwiZm9yIjoxLHN0YXRpY19jYXN0OjIsdW5pb246MSxuYW1lc3BhY2U6MSx1bnNpZ25lZDoxLCJsb25nIjoxLCJ0aHJvdyI6MSwidm9sYXRpbGUiOjIsInN0YXRpYyI6MSwicHJvdGVjdGVkIjoxLGJvb2w6MSx0ZW1wbGF0ZToxLG11dGFibGU6MSwiaWYiOjEsInB1YmxpYyI6MSxmcmllbmQ6MiwiZG8iOjEsInJldHVybiI6MSwiZ290byI6MSxhdXRvOjEsInZvaWQiOjIsImVudW0iOjEsImVsc2UiOjEsImJyZWFrIjoxLCJuZXciOjEsZXh0ZXJuOjEsdXNpbmc6MSwidHJ1ZSI6MSwiY2xhc3MiOjEsYXNtOjEsImNhc2UiOjEsdHlwZWlkOjEsInNob3J0IjoxLHJlaW50ZXJwcmV0X2Nhc3Q6MiwiZGVmYXVsdCI6MSwiZG91YmxlIjoxLHJlZ2lzdGVyOjEsZXhwbGljaXQ6MSxzaWduZWQ6MSx0eXBlbmFtZToxLCJ0cnkiOjEsInRoaXMiOjEsInN3aXRjaCI6MSwiY29udGludWUiOjEsd2NoYXJfdDoxLGlubGluZToxLCJkZWxldGUiOjEsYWxpZ25vZjoxLGNoYXIxNl90OjEsY2hhcjMyX3Q6MSxjb25zdGV4cHI6MSxkZWNsdHlwZToxLG5vZXhjZXB0OjEsbnVsbHB0cjoxLHN0YXRpY19hc3NlcnQ6MSx0aHJlYWRfbG9jYWw6MSxyZXN0cmljdDoxLF9Cb29sOjEsY29tcGxleDoxfSxidWlsdF9pbjp7c3RkOjEsc3RyaW5nOjEsY2luOjEsY291dDoxLGNlcnI6MSxjbG9nOjEsc3RyaW5nc3RyZWFtOjEsaXN0cmluZ3N0cmVhbToxLG9zdHJpbmdzdHJlYW06MSxhdXRvX3B0cjoxLGRlcXVlOjEsbGlzdDoxLHF1ZXVlOjEsc3RhY2s6MSx2ZWN0b3I6MSxtYXA6MSxzZXQ6MSxiaXRzZXQ6MSxtdWx0aXNldDoxLG11bHRpbWFwOjEsdW5vcmRlcmVkX3NldDoxLHVub3JkZXJlZF9tYXA6MSx1bm9yZGVyZWRfbXVsdGlzZXQ6MSx1bm9yZGVyZWRfbXVsdGltYXA6MSxhcnJheToxLHNoYXJlZF9wdHI6MX19O3JldHVybntkTTp7azphLGk6IjwvIixjOltobGpzLkNMQ00saGxqcy5DQkxDTE0saGxqcy5RU00se2NOOiJzdHJpbmciLGI6IidcXFxcPy4iLGU6IiciLGk6Ii4ifSx7Y046Im51bWJlciIsYjoiXFxiKFxcZCsoXFwuXFxkKik/fFxcLlxcZCspKHV8VXxsfEx8dWx8VUx8ZnxGKSJ9LGhsanMuQ05NLHtjTjoicHJlcHJvY2Vzc29yIixiOiIjIixlOiIkIn0se2NOOiJzdGxfY29udGFpbmVyIixiOiJcXGIoZGVxdWV8bGlzdHxxdWV1ZXxzdGFja3x2ZWN0b3J8bWFwfHNldHxiaXRzZXR8bXVsdGlzZXR8bXVsdGltYXB8dW5vcmRlcmVkX21hcHx1bm9yZGVyZWRfc2V0fHVub3JkZXJlZF9tdWx0aXNldHx1bm9yZGVyZWRfbXVsdGltYXB8YXJyYXkpXFxzKjwiLGU6Ij4iLGs6YSxyOjEwLGM6WyJzZWxmIl19XX19fSgpO2hsanMuTEFOR1VBR0VTLnI9e2RNOntjOltobGpzLkhDTSx7Y046Im51bWJlciIsYjoiXFxiMFt4WF1bMC05YS1mQS1GXStbTGldP1xcYiIsZTpobGpzLklNTUVESUFURV9SRSxyOjB9LHtjTjoibnVtYmVyIixiOiJcXGJcXGQrKD86W2VFXVsrXFwtXT9cXGQqKT9MXFxiIixlOmhsanMuSU1NRURJQVRFX1JFLHI6MH0se2NOOiJudW1iZXIiLGI6IlxcYlxcZCtcXC4oPyFcXGQpKD86aVxcYik/IixlOmhsanMuSU1NRURJQVRFX1JFLHI6MX0se2NOOiJudW1iZXIiLGI6IlxcYlxcZCsoPzpcXC5cXGQqKT8oPzpbZUVdWytcXC1dP1xcZCopP2k/XFxiIixlOmhsanMuSU1NRURJQVRFX1JFLHI6MH0se2NOOiJudW1iZXIiLGI6IlxcLlxcZCsoPzpbZUVdWytcXC1dP1xcZCopP2k/XFxiIixlOmhsanMuSU1NRURJQVRFX1JFLHI6MX0se2NOOiJrZXl3b3JkIixiOiIoPzp0cnlDYXRjaHxsaWJyYXJ5fHNldEdlbmVyaWN8c2V0R3JvdXBHZW5lcmljKVxcYiIsZTpobGpzLklNTUVESUFURV9SRSxyOjEwfSx7Y046ImtleXdvcmQiLGI6IlxcLlxcLlxcLiIsZTpobGpzLklNTUVESUFURV9SRSxyOjEwfSx7Y046ImtleXdvcmQiLGI6IlxcLlxcLlxcZCsoPyFbXFx3Ll0pIixlOmhsanMuSU1NRURJQVRFX1JFLHI6MTB9LHtjTjoia2V5d29yZCIsYjoiXFxiKD86ZnVuY3Rpb24pIixlOmhsanMuSU1NRURJQVRFX1JFLHI6Mn0se2NOOiJrZXl3b3JkIixiOiIoPzppZnxpbnxicmVha3xuZXh0fHJlcGVhdHxlbHNlfGZvcnxyZXR1cm58c3dpdGNofHdoaWxlfHRyeXxzdG9wfHdhcm5pbmd8cmVxdWlyZXxhdHRhY2h8ZGV0YWNofHNvdXJjZXxzZXRNZXRob2R8c2V0Q2xhc3MpXFxiIixlOmhsanMuSU1NRURJQVRFX1JFLHI6MX0se2NOOiJsaXRlcmFsIixiOiIoPzpOQXxOQV9pbnRlZ2VyX3xOQV9yZWFsX3xOQV9jaGFyYWN0ZXJffE5BX2NvbXBsZXhfKVxcYiIsZTpobGpzLklNTUVESUFURV9SRSxyOjEwfSx7Y046ImxpdGVyYWwiLGI6Iig/Ok5VTEx8VFJVRXxGQUxTRXxUfEZ8SW5mfE5hTilcXGIiLGU6aGxqcy5JTU1FRElBVEVfUkUscjoxfSx7Y046ImlkZW50aWZpZXIiLGI6IlthLXpBLVouXVthLXpBLVowLTkuX10qXFxiIixlOmhsanMuSU1NRURJQVRFX1JFLHI6MH0se2NOOiJvcGVyYXRvciIsYjoiPFxcLSg/IVxccypcXGQpIixlOmhsanMuSU1NRURJQVRFX1JFLHI6Mn0se2NOOiJvcGVyYXRvciIsYjoiXFwtPnw8XFwtIixlOmhsanMuSU1NRURJQVRFX1JFLHI6MX0se2NOOiJvcGVyYXRvciIsYjoiJSV8fiIsZTpobGpzLklNTUVESUFURV9SRX0se2NOOiJvcGVyYXRvciIsYjoiPj18PD18PT18IT18XFx8XFx8fCYmfD18XFwrfFxcLXxcXCp8L3xcXF58Pnw8fCF8JnxcXHx8XFwkfDoiLGU6aGxqcy5JTU1FRElBVEVfUkUscjowfSx7Y046Im9wZXJhdG9yIixiOiIlIixlOiIlIixpOiJcXG4iLHI6MX0se2NOOiJpZGVudGlmaWVyIixiOiJgIixlOiJgIixyOjB9LHtjTjoic3RyaW5nIixiOiciJyxlOiciJyxjOltobGpzLkJFXSxyOjB9LHtjTjoic3RyaW5nIixiOiInIixlOiInIixjOltobGpzLkJFXSxyOjB9LHtjTjoicGFyZW4iLGI6IltbKHtcXF0pfV0iLGU6aGxqcy5JTU1FRElBVEVfUkUscjowfV19fTsKaGxqcy5pbml0SGlnaGxpZ2h0aW5nT25Mb2FkKCk7Cgo="></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>


<link href="data:text/css;charset=utf-8,body%2C%20td%7Bfont%2Dfamily%3Asans%2Dserif%3Bbackground%2Dcolor%3Awhite%3Bfont%2Dsize%3A13px%7Dbody%7Bmax%2Dwidth%3A800px%3Bmargin%3A0%20auto%3Bpadding%3A1em%201em%202em%3Bline%2Dheight%3A20px%7Ddiv%23TOC%20li%7Blist%2Dstyle%3Anone%3Bbackground%2Dimage%3Anone%3Bbackground%2Drepeat%3Anone%3Bbackground%2Dposition%3A0%7Dp%2C%20pre%7Bmargin%3A0em%200em%201em%7Dimg%2C%20table%7Bmargin%3A0em%20auto%201em%7Dp%7Btext%2Dalign%3Ajustify%7Dtt%2C%20code%2C%20pre%7Bfont%2Dfamily%3A%27DejaVu%20Sans%20Mono%27%2C%20%27Droid%20Sans%20Mono%27%2C%20%27Lucida%20Console%27%2C%20Consolas%2C%20Monaco%2C%20monospace%7Dh1%2C%20h2%2C%20h3%2C%20h4%2C%20h5%2C%20h6%7Bfont%2Dfamily%3AHelvetica%2C%20Arial%2C%20sans%2Dserif%3Bmargin%3A1%2E2em%200em%200%2E6em%200em%3Bfont%2Dweight%3Abold%7Dh1%2Etitle%7Bfont%2Dsize%3A250%25%3Bfont%2Dweight%3Anormal%3Bcolor%3A%2387b13f%3Bline%2Dheight%3A1%2E1em%3Bmargin%2Dtop%3A0px%3Bborder%2Dbottom%3A0px%7Dh1%7Bfont%2Dsize%3A160%25%3Bfont%2Dweight%3Anormal%3Bline%2Dheight%3A1%2E4em%3Bborder%2Dbottom%3A1px%20%231a81c2%20solid%7Dh2%7Bfont%2Dsize%3A130%25%7Dh1%2C%20h2%2C%20h3%7Bcolor%3A%231a81c2%7Dh3%2C%20h4%2C%20h5%2C%20h6%7Bfont%2Dsize%3A115%25%7Da%7Bcolor%3A%231a81c2%7Da%3Aactive%7Boutline%3Anone%7Da%3Avisited%7Bcolor%3A%231a81c2%7Da%3Ahover%7Bcolor%3A%234c94c2%7Dpre%2C%20img%7Bmax%2Dwidth%3A100%25%3Bdisplay%3Ablock%7Dpre%7Bborder%3A0px%20none%3Bbackground%2Dcolor%3A%23F8F8F8%3Bwhite%2Dspace%3Apre%3Boverflow%2Dx%3Aauto%7Dpre%20code%7Bborder%3A1px%20%23aaa%20dashed%3Bbackground%2Dcolor%3Awhite%3Bdisplay%3Ablock%3Bpadding%3A1em%3Bcolor%3A%23111%3Boverflow%2Dx%3Ainherit%7Dpre%20code%5Bclass%5D%7Bbackground%2Dcolor%3Ainherit%7Dpre%5Bclass%5D%20code%7Bbackground%2Dcolor%3Ainherit%7Dcode%7Bbackground%2Dcolor%3Atransparent%3Bcolor%3A%2387b13f%3Bfont%2Dsize%3A92%25%7Dtable%2C%20td%2C%20th%7Bborder%3Anone%3Bpadding%3A0%200%2E5em%7Dtbody%20tr%3Anth%2Dchild%28odd%29%20td%7Bbackground%2Dcolor%3A%23F8F8F8%7Dblockquote%7Bcolor%3A%23666666%3Bmargin%3A0%3Bpadding%2Dleft%3A1em%3Bborder%2Dleft%3A0%2E5em%20%23EEE%20solid%7Dhr%7Bheight%3A0px%3Bborder%2Dbottom%3Anone%3Bborder%2Dtop%2Dwidth%3Athin%3Bborder%2Dtop%2Dstyle%3Adotted%3Bborder%2Dtop%2Dcolor%3A%23999999%7Dspan%2Eheader%2Dsection%2Dnumber%7Bpadding%2Dright%3A1em%7Dspan%2Etoc%2Dsection%2Dnumber%3A%3Aafter%7Bcontent%3A%22%20%20%22%3Bwhite%2Dspace%3Apre%7D%40media%20print%7B%2A%7Bbackground%3Atransparent%20%21important%3Bcolor%3Ablack%20%21important%3Bfilter%3Anone%20%21important%3B%2Dms%2Dfilter%3Anone%20%21important%7Dbody%7Bfont%2Dsize%3A12pt%3Bmax%2Dwidth%3A100%25%7Da%2C%20a%3Avisited%7Btext%2Ddecoration%3Aunderline%7Dhr%7Bvisibility%3Ahidden%3Bpage%2Dbreak%2Dbefore%3Aalways%7Dpre%2C%20blockquote%7Bpadding%2Dright%3A1em%3Bpage%2Dbreak%2Dinside%3Aavoid%7Dtr%2C%20img%7Bpage%2Dbreak%2Dinside%3Aavoid%7Dimg%7Bmax%2Dwidth%3A100%25%20%21important%7D%40page%20%3Aleft%7Bmargin%3A15mm%2020mm%2015mm%2010mm%7D%40page%20%3Aright%7Bmargin%3A15mm%2010mm%2015mm%2020mm%7Dp%2C%20h2%2C%20h3%7Borphans%3A3%3Bwidows%3A3%7Dh2%2C%20h3%7Bpage%2Dbreak%2Dafter%3Aavoid%7D%7D" rel="stylesheet" type="text/css" />

<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  var links = document.links;  
  for (var i = 0, linksLength = links.length; i < linksLength; i++)
    if(links[i].hostname != window.location.hostname)
      links[i].target = '_blank';
});
</script>

</head>

<body>


<div id="header">
<h1 class="title">Simulate reads</h1>
<h4 class="author"><em>L Collado-Torres</em></h4>
<h4 class="date"><em>19 November 2015</em></h4>
</div>

<h1>Contents</h1>
<div id="TOC">
<ul>
<li><a href="#setup"><span class="toc-section-number">0.1</span> Setup</a></li>
<li><a href="#code"><span class="toc-section-number">0.2</span> Code</a></li>
</ul>
</div>

<p>Simulate reads using <a href="http://www.bioconductor.org/packages/polyester">polyester</a>.</p>
<div id="setup" class="section level2">
<h2><span class="header-section-number">0.1</span> Setup</h2>
<p>This code uses the genes from chr17 from the UCSC hg19 known gene database to simulate reads for a two group comparison with 5 samples per group. The number of reads corresponds to what you would expect from libraries with 40 million reads used to sequence the whole human genome. We identify all the transcripts in chr17 and set 1/6 of them to be high, 1/6 of them to be low and the rest the same between the two groups. The differences are 2x and the reads per transcript take into account the transcript length. Reads are 100bp long and come from paired-end reads with mean fragment lengths of 250bp (25bp sd) and a uniform error rate of 0.005. The <code>size</code> is set to 1/3 of the mean in the negative binomial model.</p>
</div>
<div id="code" class="section level2">
<h2><span class="header-section-number">0.2</span> Code</h2>
<pre class="r"><code>library('TxDb.Hsapiens.UCSC.hg19.knownGene')</code></pre>
<pre><code>## Loading required package: GenomicFeatures
## Loading required package: BiocGenerics
## Loading required package: methods
## Loading required package: parallel
## 
## Attaching package: 'BiocGenerics'
## 
## The following objects are masked from 'package:parallel':
## 
##     clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
##     clusterExport, clusterMap, parApply, parCapply, parLapply,
##     parLapplyLB, parRapply, parSapply, parSapplyLB
## 
## The following objects are masked from 'package:stats':
## 
##     IQR, mad, xtabs
## 
## The following objects are masked from 'package:base':
## 
##     anyDuplicated, append, as.data.frame, as.vector, cbind,
##     colnames, do.call, duplicated, eval, evalq, Filter, Find, get,
##     grep, grepl, intersect, is.unsorted, lapply, lengths, Map,
##     mapply, match, mget, order, paste, pmax, pmax.int, pmin,
##     pmin.int, Position, rank, rbind, Reduce, rownames, sapply,
##     setdiff, sort, table, tapply, union, unique, unlist, unsplit
## 
## Loading required package: S4Vectors
## Loading required package: stats4
## 
## Attaching package: 'S4Vectors'
## 
## The following object is masked from 'package:base':
## 
##     expand.grid
## 
## Loading required package: IRanges
## Loading required package: GenomeInfoDb
## Loading required package: GenomicRanges
## Loading required package: AnnotationDbi
## Loading required package: Biobase
## Welcome to Bioconductor
## 
##     Vignettes contain introductory material; view with
##     'browseVignettes()'. To cite Bioconductor, see
##     'citation(&quot;Biobase&quot;)', and for packages 'citation(&quot;pkgname&quot;)'.</code></pre>
<pre><code>## Warning in .recacheSubclasses(def@className, def,
## doSubclasses, env): undefined subclass &quot;GIntervalTree&quot; of class
## &quot;GenomicRangesORGenomicRangesList&quot;; definition not updated</code></pre>
<pre><code>## Warning in .recacheSubclasses(def@className, def, doSubclasses, env):
## undefined subclass &quot;GIntervalTree&quot; of class &quot;RangedDataORGenomicRanges&quot;;
## definition not updated</code></pre>
<pre class="r"><code>library('polyester')
library('Biostrings')</code></pre>
<pre><code>## Loading required package: XVector</code></pre>
<pre class="r"><code>library('devtools')

## Fold changes
foldChange &lt;- list(high = 2, low = 1/2)

## Find transcripts
txdb &lt;- keepSeqlevels(TxDb.Hsapiens.UCSC.hg19.knownGene, 'chr17')
tx &lt;- transcriptsBy(txdb, 'gene')

## Transcripts per gene
txs &lt;- sapply(tx, length)
barplot(table(txs), main = 'Number of transcripts per gene in chr17 based on hg19')</code></pre>
<p><img src="data:image/png;base64,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" alt /></p>
<pre class="r"><code>## Download info for chr17
if(!file.exists('knownGeneTxMrna.txt.gz')) download.file('http://hgdownload.cse.ucsc.edu/goldenPath/hg19/database/knownGeneTxMrna.txt.gz', 'knownGeneTxMrna.txt.gz')
mrna &lt;- read.table('knownGeneTxMrna.txt.gz', header = FALSE, sep = '\t', quote = '', stringsAsFactors = FALSE, col.names = c('ucsckg', 'sequence'))

## Use all genes from chr17
chosen &lt;- data.frame(
    tx_idx = rep(seq_len(length(txs)), txs),
    tx_n = rep(txs, txs),
    tx_i = unlist(sapply(txs, seq_len), use.names = FALSE)
)

## Add gene id
chosen$gene_id &lt;- names(tx)[chosen$tx_idx]
chosen$ucsckg_id &lt;- unlist(lapply(tx, function(x) x$tx_name), use.names = FALSE)

m &lt;- match(chosen$ucsckg_id, mrna$ucsckg)
fasta &lt;- DNAStringSet(mrna$sequence[m])
names(fasta) &lt;- mrna$ucsckg[m]

## Write fasta file
writeXStringSet(fasta, 'chr17_chosen.fa')



## For a library size of 40 million reads, find out how many would be from chr17
## Based on chr length it would be about 2.6% of the 40 million reads:
data(hg19Ideogram, package = 'biovizBase')
seqlengths(hg19Ideogram)['chr17'] / sum(as.numeric(seqlengths(hg19Ideogram)[paste0('chr', c(1:22, 'X', 'Y'))])) * 100</code></pre>
<pre><code>##    chr17 
## 2.622858</code></pre>
<pre class="r"><code>## Based on the total length of mRNA it's about 5.1%. This assumes that all
## base-pairs contained in mRNAs are equally expressed
sum(width(fasta)) / sum(nchar(mrna$sequence)) * 100</code></pre>
<pre><code>## [1] 4.973116</code></pre>
<pre class="r"><code>## We'll use the percent based on the total mRNA, meaning that the total number
## of reads would be about 2 million
reads_chr17 &lt;- round(sum(width(fasta)) / sum(nchar(mrna$sequence)) * 40e6)
reads_chr17</code></pre>
<pre><code>## [1] 1989247</code></pre>
<pre class="r"><code>## Now we can determine the number of reads per transcript based on a library 
## size of 40 million reads where each read is 100 bp long.
chosen$width &lt;- width(fasta)
chosen$readspertx &lt;- round(reads_chr17 * 100 / sum(chosen$width) * chosen$width / 100)
## Missed just 18 reads due to rounding
sum(chosen$readspertx) - reads_chr17</code></pre>
<pre><code>## [1] 22</code></pre>
<pre class="r"><code>## Choose which transcripts are DE in each of the 3 replicate experiments
## Group 1 will be the baseline, group 2 will have the DE signal
n_de &lt;- round(nrow(chosen) / 6)
status &lt;- rep(c('high', 'low', 'normal'), c(n_de, n_de, nrow(chosen) - 2 * n_de))
set.seed(20151119)
chosen$rep1 &lt;- sample(status)
chosen$rep2 &lt;- sample(status)
chosen$rep3 &lt;- sample(status)

## Identify the base means for group 2 in each of the 3 replicates
chosen$meanR1 &lt;- round(chosen$readspertx * ifelse(chosen$rep1 == 'normal', 1, ifelse(chosen$rep1 == 'high', foldChange$high, foldChange$low)) )
chosen$meanR2 &lt;- round(chosen$readspertx * ifelse(chosen$rep2 == 'normal', 1, ifelse(chosen$rep2 == 'high', foldChange$high, foldChange$low)) )
chosen$meanR3 &lt;- round(chosen$readspertx * ifelse(chosen$rep3 == 'normal', 1, ifelse(chosen$rep3 == 'high', foldChange$high, foldChange$low)) )

## Generate the count matrix
readmat &lt;- matrix(NA, nrow = nrow(chosen), ncol = 3 * 10)
for(i in seq_len(30)) {
    if (i %in% c(1:5, 11:15, 21:25)) {
        means &lt;- chosen$readspertx
    } else if (i %in% 6:10) {
        means &lt;- chosen$meanR1    
    } else if (i %in% 16:20) {
        means &lt;- chosen$meanR2    
    } else {
        means &lt;- chosen$meanR3
    }
    readmat[, i] &lt;- mapply(polyester:::NB, means, means / 3)
}
colnames(readmat) &lt;- paste0(rep(paste0('sample', 1:10, 'G', rep(1:2, each = 5)), 3), 'R', rep(1:3, each = 10))
rownames(readmat) &lt;- chosen$ucsckg_id

## Classify txs by DE status
class_de &lt;- function(gene, col) {
    s &lt;- subset(chosen, gene_id == gene)
    status &lt;- s[[col]]
    if(nrow(s) &gt; 1) {
        res &lt;- ifelse(all(status == 'normal'), 'noneDE', ifelse(all(status %in% c('high', 'low')), 'allDE', 'someDE'))
    } else {
        res &lt;- ifelse(status %in% c('high', 'low'), 'singleDE', 'singleNotDE') 
    }
    return(res)
}
chosen$case1 &lt;- sapply(chosen$gene_id, class_de, col = 'rep1')
chosen$case2 &lt;- sapply(chosen$gene_id, class_de, col = 'rep2')
chosen$case3 &lt;- sapply(chosen$gene_id, class_de, col = 'rep3')

## At the transcript level, how does the DE status look like?
sapply(paste0('case', 1:3), function(x) { table(chosen[[x]])})</code></pre>
<pre><code>##             case1 case2 case3
## allDE          84   101    71
## noneDE        649   646   596
## singleDE      193   157   174
## singleNotDE   321   357   340
## someDE       2653  2639  2719</code></pre>
<pre class="r"><code>## What about the gene level?
sapply(paste0('case', 1:3), function(x) { table(chosen[[x]][chosen$tx_i == 1])})</code></pre>
<pre><code>##             case1 case2 case3
## allDE          38    43    33
## noneDE        227   226   213
## singleDE      193   157   174
## singleNotDE   321   357   340
## someDE        559   555   578</code></pre>
<pre class="r"><code>## Save parameters
save(chosen, readmat, foldChange, file = 'simulation_info.Rdata')

## Run simulation
outdir &lt;- file.path('..', 'simulated_reads')
simulate_experiment_countmat(fasta = 'chr17_chosen.fa', readmat = readmat, outdir = outdir, fraglen = 250, fragsd = 25, readlen = 100, error_rate = 0.005, paired = TRUE, seed = '20151119')

## gzip fasta files
for(i in seq_len(30)) {
    for(j in 1:2) {
        system(paste('gzip', file.path(outdir, paste0(&quot;sample_&quot;, sprintf('%02d', i), &quot;_&quot;, j, &quot;.fasta&quot;))))
    }
}

## Generated pairs info file for running TopHat or HISAT
{
sink(file.path(outdir, &quot;paired.txt&quot;))
for(i in seq_len(30)) {
    cat(paste0(&quot;sample_&quot;, sprintf('%02d', i), &quot;_1.fasta.gz\tsample_&quot;, sprintf('%02d', i), &quot;_2.fasta.gz\t&quot;, colnames(readmat)[i], &quot;\n&quot;))
}
sink()
}

## Reproducibility info
Sys.time()</code></pre>
<pre><code>## [1] &quot;2015-11-19 16:13:58 EST&quot;</code></pre>
<pre class="r"><code>proc.time()</code></pre>
<pre><code>##     user   system  elapsed 
## 4552.767   96.418 4798.872</code></pre>
<pre class="r"><code>session_info()</code></pre>
<pre><code>## Session info --------------------------------------------------------------</code></pre>
<pre><code>##  setting  value                                             
##  version  R Under development (unstable) (2015-08-31 r69229)
##  system   x86_64, linux-gnu                                 
##  ui       X11                                               
##  language (EN)                                              
##  collate  en_US.UTF-8                                       
##  tz       &lt;NA&gt;                                              
##  date     2015-11-19</code></pre>
<pre><code>## Packages ------------------------------------------------------------------</code></pre>
<pre><code>##  package                           * version  date      
##  AnnotationDbi                     * 1.33.1   2015-10-30
##  Biobase                           * 2.31.0   2015-10-20
##  BiocGenerics                      * 0.17.1   2015-11-07
##  BiocParallel                        1.5.0    2015-11-03
##  BiocStyle                         * 1.9.2    2015-11-03
##  biomaRt                             2.27.0   2015-10-20
##  Biostrings                        * 2.39.1   2015-11-19
##  bitops                              1.0-6    2013-08-17
##  DBI                                 0.3.1    2014-09-24
##  devtools                          * 1.9.1    2015-09-11
##  digest                              0.6.8    2014-12-31
##  evaluate                            0.8      2015-09-18
##  formatR                             1.2.1    2015-09-18
##  futile.logger                       1.4.1    2015-04-20
##  futile.options                      1.0.0    2010-04-06
##  GenomeInfoDb                      * 1.7.3    2015-11-03
##  GenomicAlignments                   1.7.3    2015-11-05
##  GenomicFeatures                   * 1.23.8   2015-11-06
##  GenomicRanges                     * 1.23.3   2015-11-07
##  htmltools                           0.2.6    2014-09-08
##  IRanges                           * 2.5.5    2015-11-03
##  knitr                               1.11     2015-08-14
##  lambda.r                            1.1.7    2015-03-20
##  limma                               3.27.5   2015-11-17
##  logspline                           2.1.8    2015-07-03
##  magrittr                            1.5      2014-11-22
##  memoise                             0.2.1    2014-04-22
##  polyester                         * 1.7.1    2015-11-19
##  RCurl                               1.95-4.7 2015-06-30
##  rmarkdown                           0.8.1    2015-10-10
##  Rsamtools                           1.23.1   2015-11-03
##  RSQLite                             1.0.0    2014-10-25
##  rtracklayer                         1.31.1   2015-10-23
##  S4Vectors                         * 0.9.9    2015-11-19
##  stringi                             1.0-1    2015-10-22
##  stringr                             1.0.0    2015-04-30
##  SummarizedExperiment                1.1.2    2015-11-19
##  TxDb.Hsapiens.UCSC.hg19.knownGene * 3.2.2    2015-10-19
##  XML                                 3.98-1.3 2015-06-30
##  XVector                           * 0.11.0   2015-10-20
##  yaml                                2.1.13   2014-06-12
##  zlibbioc                            1.17.0   2015-10-20
##  source                                
##  Bioconductor                          
##  Bioconductor                          
##  Bioconductor                          
##  Bioconductor                          
##  Bioconductor                          
##  Bioconductor                          
##  Bioconductor                          
##  CRAN (R 3.2.0)                        
##  CRAN (R 3.2.0)                        
##  CRAN (R 3.3.0)                        
##  CRAN (R 3.2.0)                        
##  CRAN (R 3.3.0)                        
##  CRAN (R 3.3.0)                        
##  CRAN (R 3.3.0)                        
##  CRAN (R 3.2.0)                        
##  Bioconductor                          
##  Bioconductor                          
##  Bioconductor                          
##  Bioconductor                          
##  CRAN (R 3.2.0)                        
##  Bioconductor                          
##  CRAN (R 3.3.0)                        
##  CRAN (R 3.3.0)                        
##  Bioconductor                          
##  CRAN (R 3.3.0)                        
##  CRAN (R 3.3.0)                        
##  CRAN (R 3.2.0)                        
##  Github (lcolladotor/polyester@a07d933)
##  CRAN (R 3.3.0)                        
##  CRAN (R 3.3.0)                        
##  Bioconductor                          
##  CRAN (R 3.2.0)                        
##  Bioconductor                          
##  Bioconductor                          
##  CRAN (R 3.3.0)                        
##  CRAN (R 3.3.0)                        
##  Bioconductor                          
##  Bioconductor                          
##  CRAN (R 3.3.0)                        
##  Bioconductor                          
##  CRAN (R 3.3.0)                        
##  Bioconductor</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
